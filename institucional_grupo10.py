# -*- coding: utf-8 -*-
"""institucional_grupo10.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/gist/roperoangie23-byte/7a5d0288a6e7579d9e75585b35d72cf8/institucional_grupo10.ipynb
"""

# Commented out IPython magic to ensure Python compatibility.
# %pip install streamlit

"""%pip install instala las librer√≠as necesarias (solo se ejecuta una vez en tu entorno, no dentro de la app)."""

#Importamos las librerias
import streamlit as st
import pandas as pd
import yfinance as yf

"""streamlit ‚Üí construye la interfaz web interactiva.

pandas ‚Üí maneja los datos en forma de tablas (DataFrames).

yfinance ‚Üí descarga los precios hist√≥ricos de las acciones.
"""

st.title("BIENVENIDOS AL GRUPO 10")
st.markdown(
    """
    <h1 style='text-align: center; color: #1E90FF;'>
        BIENVENIDOS AL GRUPO 10 üíº
    </h1>""",
    unsafe_allow_html=True)

st.header("An√°lisis de Rentabilidad y Riesgo üìä")
st.write("""Este proyecto analiza el comportamiento financiero de tres grandes empresas colombianas.
        A trav√©s de indicadores como la <b>rentabilidad esperada</b>, la <b>volatilidad</b> y el <b>Ratio de Sharpe</b>,
        evaluamos la relaci√≥n entre riesgo y retorno para identificar el portafolio m√°s eficiente. üá®üá¥üíº""")

"""st.markdown() muestra texto HTML con formato (colores, tama√±os, alineaci√≥n).

unsafe_allow_html=True le permite interpretar etiquetas HTML.

Es b√°sicamente una forma bonita de mostrar el t√≠tulo principal.

üí° En Streamlit tambi√©n podr√≠as usar st.title(), pero con markdown puedes personalizar mucho m√°s.
"""

#tickter inicial
diccionario_tickers = {"Ecopetrol": "EC",
    "Bancolombia": "CIB",
    "Grupo Aval": "AVAL",
    "Grupo Sura": "GIVSY"}

"""El diccionario,  esto est√° buen√≠simo si quieremos manejar nombres m√°s legibles para el usuario üëè"""

#multiselector
tickers_seleccionados = st.multiselect("Elija una o m√°s empresas para analizar:", list(diccionario_tickers.keys()))

"""Multiselect: te permite elegir las empresas que quieres analizar."""

# Imagen decorativa
st.image("https://cdn.pixabay.com/photo/2017/06/16/07/37/stock-exchange-2408858_1280.jpg", use_column_width=True)

#  Bot√≥n para calcular rentabilidad y riesgo

if st.button("Calcular Rentabilidad y Riesgo"):
    if not tickers_seleccionados:
        st.warning("Selecciona al menos una empresa para continuar.")
    else:
        # Descargar datos hist√≥ricos
        tickers_yf = [lista_tickers[t] for t in tickers_seleccionados]
        data = yf.download(tickers=tickers_yf, period="6mo")["Close"]

        # Calcular rentabilidades diarias
        rent_diaria = data.pct_change().dropna()

        # Calcular m√©tricas
        rent_promedio = rent_diaria.mean() * 252  # anualizada
        riesgo = rent_diaria.std() * (252 ** 0.5)  # desviaci√≥n est√°ndar anualizada
        sharpe = rent_promedio / riesgo

        # Crear DataFrame resumen
        resumen = pd.DataFrame({
            "Rentabilidad esperada (%)": rent_promedio * 100,
            "Riesgo (Volatilidad %)": riesgo * 100,
            "Ratio Sharpe": sharpe
        })

        # Mostrar resultados
        st.subheader(" Comparaci√≥n de Empresas:")
        st.dataframe(resumen.style.format("{:.2f}"))

        #Gr√°fico de comparaci√≥n
        st.subheader("Gr√°fico de Rentabilidad vs Riesgo")
        fig, ax = plt.subplots()
        ax.scatter(riesgo * 100, rent_promedio * 100, color="blue")

        for i, txt in enumerate(resumen.index):
            ax.annotate(txt, (riesgo[i] * 100, rent_promedio[i] * 100))

        ax.set_xlabel("Riesgo (Volatilidad %)")
        ax.set_ylabel("Rentabilidad Esperada (%)")
        ax.set_title("Rendimiento vs Riesgo")
        st.pyplot(fig)
else:
    st.info("Presiona el bot√≥n para analizar la rentabilidad y riesgo de las empresas seleccionadas.")

"""
Bot√≥n: descarga precios de los √∫ltimos 6 meses con yfinance.

**C√°lculos:**

*Rentabilidad esperada* = media anualizada de los retornos diarios.

*Riesgo* = desviaci√≥n est√°ndar anualizada (volatilidad).

*Ratio de Sharpe* = mide la eficiencia riesgo/rentabilidad.

**Tabla**: compara las m√©tricas de todas las empresas.

**Gr√°fico**: visualiza la relaci√≥n riesgo‚Äìrentabilidad.

**Imagen**: embellece la interfaz"""